<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="./tailwindcss.js"></script>
    <!-- <script src="./html2pdf.bundle.min.js"></script> -->
    <link rel="icon" type="image/x-icon" href="images/default.png" />
    <title>
      大翻墙运动 信息倒灌行动 拆墙运动 墙倒众人推 普及翻墙 完全免费翻墙软件 VPN
    </title>
    <meta charset="UTF-8" />
    <meta
      name="description"
      content="大翻墙运动 信息倒灌行动 墙倒众人推 拆除互联网防火墙 拆墙运动 声援乔鑫鑫 杨泽伟 编程随想 阮晓寰 厕所革命 自由福建 周鋒 FengZhou 一人一推 惡人榜 拆牆運動 闽越合众国 恶人榜 推墙大联盟 李老师不是你老师 中国新闻 中国禁闻 中国审查 GFW 自由 民主 人权 宪政 防火墙 突破防火墙 国内新闻 中国热点事件 中国新闻总结 李老师不是你老师 推文离线下载 离线PDF推文 免费翻墙 翻墙节点 敏感词"
    />
    <meta
      name="keywords"
      content="大翻墙运动 信息倒灌行动 墙倒众人推 完全免费翻墙软件 梯子 机场 拆墙机场 回国机场 回国梯子 厕所革命 自由福建 周鋒 FengZhou 一人一推 惡人榜 拆牆運動 闽越合众国 恶人榜 代理 Vmess Shadowsocks Trojan v2ray v2board Shadowrocket GFW 突破防火墙 VPN 防火墙 拆墙运动 拆墙 推墙 fanqiang 科学上网 自由上网 免费科学上网 免费翻墙 油管youtube 电脑、手机、iOS、安卓、windows、Mac、Linux 推特 推墙大联盟 李老师不是你老师 中国新闻 中国禁闻 中国审查 GFW 自由 民主 人权 宪政 防火墙 突破防火墙 国内新闻 中国热点事件 中国新闻总结 李老师不是你老师 推文离线下载 离线PDF推文 免费翻墙 翻墙节点 敏感词"
    />

    <script
      src="./crypto-js.min.js"
      integrity="sha512-a+SUDuwNzXDvz4XrIcXHuCf089/iJAoN4lmrXJg18XnduKK6YlDHNRalv4yd1N40OKI80tFidF+rqTFKGPoWFQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>

    <script src="./hmac-sha1.min.js"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            gridTemplateColumns: {
              14: 'repeat(14, minmax(0, 1fr))',
            },
          },
        },
      };
    </script>

    <script>
      fetch('header.html')
        .then((response) => response.text())
        .then((text) => {
          document.getElementById('header').innerHTML = text;

          const mobileHeader = document.getElementById('mobile-header');
          const closeMenu = document.getElementById('close-menu');
          const openMenu = document.getElementById('open-menu');

          mobileHeader.classList.add('hidden');

          closeMenu.onclick = () => {
            mobileHeader.classList.add('hidden');
          };

          openMenu.onclick = () => {
            mobileHeader.classList.remove('hidden');
          };
        });

      fetch('footer.html')
        .then((response) => response.text())
        .then((text) => {
          document.getElementById('footer').innerHTML = text;

          const currentYearSpan = document.getElementById('currentYear');
          const currentDate = new Date();
          const currentYear = currentDate.getFullYear();
          currentYearSpan.textContent = currentYear;

          document.getElementById('year').value = currentYear;
        });
    </script>

    <script>
      const currentDomain = window.location.hostname;

      // Check the domain and conditionally add the script
      if (
        currentDomain === 'end-gfw.com' ||
        currentDomain === 'vpn.ban-gfw.com'
      ) {
        const script = document.createElement('script');
        script.src =
          'https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7165471280882308'; // Replace with your script URL
        script.type = 'text/javascript';
        script.async = true;
        script.crossorigin = 'anonymous';

        // Append the script to the document head or body
        document.head.appendChild(script);
      }
    </script>
  </head>
  <body>
    <div id="header"></div>
    <main class="mt-20 mx-4 lg:mx-20">
      <div class="grid grid-cols-1 gap-x-1 lg:grid-cols-2 gap-x-8">
        <div class="">
          <p class="font-bold">
            动态免墙IP站点, 每天更新
            <br />
            可以安全分享到朋友圈而不被炸号
            <!-- <br />
            <a href="/download-last-7" class="font-semibold text-indigo-600"
              >点击下载过去3天新闻， 离线PDF版本</a
            > -->
          </p>

          <p id="mirror-list"></p>
          <!-- 
          <br />

          <p id="current-mirror" class="font-semibold text-indigo-600"></p>
-->
          <br />

          <h1 class="font-semibold text-indigo-600">
            本域名已添加广告，请多查看总站广告支持添加更多服务器节点
          </h1>

          <a
            href="./custom.html"
            class="text-lg leading-6 hover:text-gray-900 font-semibold text-lime-500"
            target="_blank"
            >欢迎赞助/合作/推广, 让想翻墙的人都可以翻墙</a
          >

          <br />

          <p id="v2ray_sub">
            <br />
            V2Ray订阅链接,点击链接复制
            <br />
            <button onclick="copyText('v2ray')">
              <span class="overflow-x-auto" id="v2ray">
                https://raw.githubusercontent.com/hello-world-1989/cn-news/main/end-gfw-together</span
              >
            </button>

            <span class="font-semibold text-indigo-600"
              >V2Ray订阅链接, 速度更快节点，每3天更新</span
            ><button onclick="copyText('v2ray1')">
              <span class="overflow-x-auto" id="v2ray1">
                https://raw.githubusercontent.com/hello-world-1989/v2-sub/main/end-gfw-together-</span
              >
            </button>

            <br />
            Clash订阅链接,点击链接复制
            <br />
            <button onclick="copyText('clash')">
              <span class="overflow-x-auto" id="clash">
                https://raw.githubusercontent.com/hello-world-1989/cn-news/refs/heads/main/clash.yaml</span
              >
            </button>
            <br />

            <button onclick="copyText('apple-id')" id="apple-account">
              海外苹果账户 用户名 点击此行任意位置复制
              <span class="overflow-x-auto" id="apple-id"> </span>
            </button>
            <br />

            <button onclick="copyText('apple-password')">
              过期时间:<span id="apple-expiry"></span>，
              密码，点击此行任意位置复制，
              <span class="overflow-x-auto" id="apple-password">
                https://raw.githubusercontent.com/hello-world-1989/cn-news/refs/heads/main/clash.yaml</span
              >
            </button>
          </p>

          <br />

          <div class="sm:flex sm:justify-center lg:justify-start ml-8 lg:ml-0">
            <select
              id="year"
              name="year"
              class="mt-2 inline-block sm:2/12 lg:w-2/12 rounded-md border-0 py-1.5 px-1 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-indigo-600 sm:text-sm sm:leading-6"
            >
              <option value="2022">2022</option>
              <option value="2023">2023</option>
              <option value="2024">2024</option>
              <option value="2025">2025</option>
              <option value="2026">2026</option>
              <option value="2027">2027</option>
              <option value="2028">2028</option>
              <option value="2029">2029</option>
            </select>

            <select
              id="month"
              name="month"
              class="mt-2 inline-block sm:2/12 lg:w-2/12 rounded-md border-0 py-1.5 px-1 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-indigo-600 sm:text-sm sm:leading-6"
            >
              <option selected value="">月份</option>
              <option value="01">1</option>
              <option value="02">2</option>
              <option value="03">3</option>
              <option value="04">4</option>
              <option value="05">5</option>
              <option value="06">6</option>
              <option value="07">7</option>
              <option value="08">8</option>
              <option value="09">9</option>
              <option value="10">10</option>
              <option value="11">11</option>
              <option value="12">12</option>
            </select>

            <select
              id="day"
              name="day"
              class="mt-2 inline-block sm:2/12 lg:w-2/12 rounded-md border-0 py-1.5 px-1 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-indigo-600 sm:text-sm sm:leading-6"
            >
              <option selected value="">开始日期</option>
              <option value="01">1</option>
              <option value="02">2</option>
              <option value="03">3</option>
              <option value="04">4</option>
              <option value="05">5</option>
              <option value="06">6</option>
              <option value="07">7</option>
              <option value="08">8</option>
              <option value="09">9</option>
              <option value="10">10</option>
              <option value="11">11</option>
              <option value="12">12</option>
              <option value="13">13</option>
              <option value="14">14</option>
              <option value="15">15</option>
              <option value="16">16</option>
              <option value="17">17</option>
              <option value="18">18</option>
              <option value="19">19</option>
              <option value="20">20</option>
              <option value="21">21</option>
              <option value="22">22</option>
              <option value="23">23</option>
              <option value="24">24</option>
              <option value="25">25</option>
              <option value="26">26</option>
              <option value="27">27</option>
              <option value="28">28</option>
              <option value="29">29</option>
              <option value="30">30</option>
              <option value="31">31</option>
            </select>

            <select
              id="end-day"
              name="end-day"
              class="mt-2 inline-block sm:2/12 lg:w-2/12 rounded-md border-0 py-1.5 px-1 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-indigo-600 sm:text-sm sm:leading-6"
            >
              <option selected value="">结束日期</option>
              <option value="01">1</option>
              <option value="02">2</option>
              <option value="03">3</option>
              <option value="04">4</option>
              <option value="05">5</option>
              <option value="06">6</option>
              <option value="07">7</option>
              <option value="08">8</option>
              <option value="09">9</option>
              <option value="10">10</option>
              <option value="11">11</option>
              <option value="12">12</option>
              <option value="13">13</option>
              <option value="14">14</option>
              <option value="15">15</option>
              <option value="16">16</option>
              <option value="17">17</option>
              <option value="18">18</option>
              <option value="19">19</option>
              <option value="20">20</option>
              <option value="21">21</option>
              <option value="22">22</option>
              <option value="23">23</option>
              <option value="24">24</option>
              <option value="25">25</option>
              <option value="26">26</option>
              <option value="27">27</option>
              <option value="28">28</option>
              <option value="29">29</option>
              <option value="30">30</option>
              <option value="31">31</option>
            </select>

            <div class="lg:flex lg:mt-3 lg:ml-2">(推文自2022年10月1日起)</div>
          </div>

          <div class="sm:flex sm:justify-center lg:hidden">
            <div class="mt-2 ml-2">
              <div
                class="flex rounded-md bg-white outline outline-1 -outline-offset-1 outline-gray-300 focus-within:outline focus-within:outline-2 focus-within:-outline-offset-2 focus-within:outline-indigo-600"
              >
                <input
                  type="text"
                  name="search1"
                  id="search1"
                  placeholder="输入关键词,回车键搜索"
                  class="block min-w-0 grow px-3 py-1.5 text-base text-gray-900 placeholder:text-gray-400 focus:outline focus:outline-0 sm:text-sm/6"
                />
              </div>
            </div>

            <div class="flex justify-center mt-2">
              <button
                type="submit"
                onclick="searchTweet()"
                class="flex-none incline-block rounded-md bg-indigo-600 py-1.5 px-5 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"
              >
                搜索
              </button>
            </div>

            <div class="flex justify-center mt-2">
              <button
                type="submit"
                onclick="searchTweetPage()"
                class="flex-none incline-block rounded-md bg-indigo-600 py-1.5 px-5 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"
              >
                预览下载当前搜索推文
              </button>
            </div>

            <div class="flex justify-center mt-2">
              <button
                type="submit"
                onclick="getYearlyTweet()"
                class="flex-none incline-block rounded-md bg-indigo-600 py-1.5 px-1 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"
              >
                设置年份查看年度推文
              </button>
            </div>

            <div class="flex justify-center mt-2">
              <button
                type="submit"
                onclick="getMonthlyTweet()"
                class="flex-none incline-block rounded-md bg-indigo-600 py-1.5 px-1 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"
              >
                设置年月查看月度推文
              </button>
            </div>

            <div class="flex justify-center mt-2">
              <button
                type="submit"
                onclick="getHistoryTweet()"
                class="flex-none incline-block rounded-md bg-indigo-600 py-1.5 px-1 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"
              >
                设置日期查看当天推文
              </button>
            </div>

            <div class="flex justify-center mt-2">
              <button
                type="submit"
                onclick="getTweetPage()"
                class="flex-none incline-block rounded-md bg-indigo-600 py-1.5 px-5 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"
              >
                预览下载推文
              </button>
            </div>
          </div>
        </div>
        <div class="mt-4 lg:mt-1">
          <h1 class="font-bold">翻墙软件推荐</h1>
          <h1 class="mt-4">
            安卓手机使用Outline,V2Ray,NthLink
            <a href="./vpn.html" class="font-semibold text-indigo-600"
              >下载链接</a
            >
          </h1>
          <h1>
            苹果手机苹果电脑使用<a
              href="./qa.html#apple-account"
              class="font-semibold text-indigo-600"
              >海外苹果账户</a
            >下载Outline,V2Ray,NthLink
          </h1>
          <h1>
            微软系统电脑使用Outline,V2Ray,NthLink
            <a href="./vpn.html" class="font-semibold text-indigo-600"
              >下载链接</a
            >
          </h1>

          <h1 id="outline">
            <br />
            SS密钥，点击下方复制, 导入到Outline/V2Ray
            <br />
            <p class="overflow-auto" onclick="copyText('outline1')">
              <span id="outline1"
                >https://raw.githubusercontent.com/hello-world-1989/cn-news/main/end-gfw-together-ss</span
              >
            </p>

            <br />

            <p class="overflow-auto" onclick="copyText('outline2')">
              <span id="outline2"
                >https://raw.githubusercontent.com/hello-world-1989/cn-news/main/end-gfw-together-ss</span
              >
            </p>

            <p class="overflow-auto hidden" onclick="copyText('outline3')">
              <span id="outline3"
                >https://raw.githubusercontent.com/hello-world-1989/cn-news/main/end-gfw-together-ss</span
              >
            </p>

            <p class="overflow-auto hidden" onclick="copyText('outline4')">
              <span id="outline4"
                >https://raw.githubusercontent.com/hello-world-1989/cn-news/main/end-gfw-together-ss</span
              >
            </p>

            <p class="overflow-auto hidden" onclick="copyText('outline5')">
              <span id="outline5"
                >https://raw.githubusercontent.com/hello-world-1989/cn-news/main/end-gfw-together-ss</span
              >
            </p>
          </h1>
          <div class="">
            <h1>
              一次性赞助任意金额(USD 2/5/10)，长期获得(至少3个月，最长1年)更快速度更加稳定更多线路,
            30天到期后主页输入id签到即可（需3天签到一次），联系end-gfw,
            免费获取10M/s（需3天签到一次）
            </h1>
          </div>

          <div class=" lg:flex lg:mt-3">
            <div class="mt-2 ml-2 w-2/5">
              <div
                class="flex rounded-md bg-white outline outline-1 -outline-offset-1 outline-gray-300 focus-within:outline focus-within:outline-2 focus-within:-outline-offset-2 focus-within:outline-indigo-600"
              >
                <input
                  type="text"
                  name="token"
                  id="token"
                  placeholder="输入你的id"
                  class="block min-w-0 grow px-3 py-1.5 text-base text-gray-900 placeholder:text-gray-400 focus:outline focus:outline-0 sm:text-sm/6"
                />
              </div>
            </div>

            <div class="mt-2 lg:ml-2 w-1/5 flex justify-center">
              <button
                type="submit"
                onclick="renewPlan()"
                class="flex-none incline-block rounded-md bg-indigo-600 py-1.5 px-5 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"
              >
                签到
              </button>
            </div>
            <span id="token-status" class="mt-3 hidden"></span>
          </div>

          <div class="hidden lg:flex lg:mt-3">
            <div class="mt-2 ml-2 w-1/3">
              <div
                class="flex rounded-md bg-white outline outline-1 -outline-offset-1 outline-gray-300 focus-within:outline focus-within:outline-2 focus-within:-outline-offset-2 focus-within:outline-indigo-600"
              >
                <input
                  type="text"
                  name="search2"
                  id="search2"
                  placeholder="输入关键词,回车键搜索"
                  class="block min-w-0 grow px-3 py-1.5 text-base text-gray-900 placeholder:text-gray-400 focus:outline focus:outline-0 sm:text-sm/6"
                />
              </div>
            </div>

            <div class="mt-2 lg:ml-2 w-1/3 flex justify-center">
              <button
                type="submit"
                onclick="searchTweet()"
                class="flex-none incline-block rounded-md bg-indigo-600 py-1.5 px-5 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"
              >
                搜索
              </button>
            </div>

            <div class="mt-2 lg:inline-block lg:ml-2 w-1/3">
              <button
                type="submit"
                onclick="searchTweetPage()"
                class="flex-none incline-block rounded-md bg-indigo-600 py-1.5 px-5 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"
              >
                预览下载当前搜索推文
              </button>
            </div>
          </div>

          <div class="hidden lg:flex lg:mt-3">
            <div class="mt-2 lg:inline-block lg:ml-2 w-1/3">
              <button
                type="submit"
                onclick="getYearlyTweet()"
                class="flex-none incline-block rounded-md bg-indigo-600 py-1.5 px-0.5 text-sm text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"
              >
                设置年份查看年度推文
              </button>
            </div>

            <div class="mt-2 lg:inline-block lg:ml-2 w-1/3">
              <button
                type="submit"
                onclick="getMonthlyTweet()"
                class="flex-none incline-block rounded-md bg-indigo-600 py-1.5 px-0.5 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"
              >
                设置年月查看月度推文
              </button>
            </div>

            <div class="mt-2 lg:inline-block lg:ml-2 w-1/3">
              <button
                type="submit"
                onclick="getHistoryTweet()"
                class="flex-none incline-block rounded-md bg-indigo-600 py-1.5 px-0.5 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"
              >
                设置日期查看当天推文
              </button>
            </div>

            <div class="mt-2 lg:inline-block lg:ml-2 w-1/3">
              <button
                type="submit"
                onclick="getTweetPage()"
                class="flex-none incline-block rounded-md bg-indigo-600 py-1.5 px-5 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"
              >
                预览下载推文
              </button>
            </div>
          </div>
        </div>
      </div>
      <nav
        class="isolate grid grid-cols-4 md:grid-cols-14 -space-x-px rounded-md mt-5"
        aria-label="Pagination"
        id="page-group"
      ></nav>
      <div class="flex justify-center mt-10">
        <div id="tweet">
          <div class="">
            <div class="bg-white px-4 py-5 sm:px-6">
              <div class="flex space-x-3">
                <div class="flex-shrink-0">
                  <img
                    class="h-10 w-10 rounded-full"
                    src="https://pbs.twimg.com/profile_images/1558667234855292929/RqgodvGb_400x400.jpg"
                    alt=""
                  />
                </div>
                <div class="min-w-0 flex-1">
                  <p class="text-lg font-bold text-gray-900">
                    <a href="" class="">李老师不是你老师 @whyyoutouzhele</a>
                  </p>
                  <p class="text-sm text-gray-500">
                    <a href="#" class="">北京时间0000-00-00 00:00:00发布</a>
                  </p>
                </div>
                <div class="flex flex-shrink-0 self-center">
                  <div class="relative inline-block text-left">
                    <div
                      class="absolute right-0 z-10 mt-2 w-56 origin-top-right rounded-md bg-white shadow-lg focus:outline-none"
                      role="menu"
                      aria-orientation="vertical"
                      aria-labelledby="menu-0-button"
                      tabindex="-1"
                    ></div>
                  </div>
                </div>
              </div>
            </div>
            <div class="px-4 pb-5 sm:p-6 sm:pt-0">
              <p>更新中，请稍后查看...或查看昨日新闻</p>
            </div>
          </div>
        </div>
      </div>
    </main>
    <div id="footer"></div>
    <div id="content"></div>

    <script>
      document
        .querySelector('#search1')
        .addEventListener('keypress', function (event) {
          if (event.key === 'Enter') {
            searchTweet();
          }
        });

      document
        .querySelector('#search2')
        .addEventListener('keypress', function (event) {
          if (event.key === 'Enter') {
            searchTweet();
          }
        });

      let isEmpty = true;
      function getLast7Days() {
        var today = new Date();
        var last7Days = [];
        for (var i = 0; i < 28; i++) {
          var day = new Date(today);
          day.setDate(today.getDate() - i);
          last7Days.push(formatDate(day));
        }
        return last7Days;
      }

      function convertToShanghaiTime(utcDate) {
        var shanghaiOffset = 8; // Shanghai is UTC+8
        var shanghaiDate = new Date(
          utcDate.getTime() + shanghaiOffset * 60 * 60 * 1000
        );
        return shanghaiDate;
      }

      // Get last 7 days in Shanghai time zone
      function getLast7DaysInShanghai() {
        var last7Days = getLast7Days();
        var last7DaysInShanghai = [];

        last7Days.forEach(function (date) {
          var utcDate = new Date(date + 'T00:00:00Z');
          var shanghaiDate = convertToShanghaiTime(utcDate);

          last7DaysInShanghai.push(formatDate(shanghaiDate));
        });
        return last7DaysInShanghai;
      }

      function formatDate(date) {
        var year = '' + date.getFullYear();
        var month = '' + (date.getMonth() + 1);
        var day = '' + date.getDate();

        if (month.length < 2) month = '0' + month;
        if (day.length < 2) day = '0' + day;

        return [year, month, day].join('-');
      }

      async function fetchTweet() {
        const pagesElement = document.getElementById('pages');

        const dates = getLast7DaysInShanghai();

        let i = 0;
        for (const item of dates) {
          const pageGroupElement = document.createElement('a');
          const pageGroup = document.getElementById('page-group');

          const parts = item.split('-');

          pageGroupElement.className =
            'ring-1 ring-inset ring-gray-300 relative z-10 inline-flex items-center px-4 py-2 text-sm font-semibold  focus:z-20 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600';

          for (let j = 0; j < 2; j++) {
            //await getTweet(parts[0], parts[1], parts[2]);

            if (isEmpty && i === 0) {
              const yesterday = dates[j];
              const parts = yesterday.split('-');
              await getTweet(parts[0], parts[1], parts[2]);
            }
          }

          pageGroupElement.className +=
            i == 0
              ? ' bg-indigo-600 text-white selected hover:bg-indigo-500'
              : ' text-gray-900';

          pageGroupElement.id = item;

          pageGroupElement.innerHTML = parts[1] + '-' + parts[2];

          pageGroupElement.onclick = async () => {
            const selectedOption = pageGroup.querySelector('.selected');
            if (selectedOption) {
              selectedOption.classList.remove('selected');
              selectedOption.classList.remove('bg-indigo-600');
              selectedOption.classList.remove('text-white');
              selectedOption.classList.remove('hover:bg-indigo-500');

              selectedOption.classList.add('bg-white');
              selectedOption.classList.add('text-gray-900');
              selectedOption.classList.add('hover:bg-gray-50');
              selectedOption.classList.add('ring-1');
              selectedOption.classList.add('ring-inset');
              selectedOption.classList.add('ring-gray-300');
            }

            //const folder = parts[0] + '/' + parts[1] + '/' + parts[2];

            await getTweet(parts[0], parts[1], parts[2]);

            // const activeVPN = vpn.filter(
            //  (item) => item.os == pageGroupElement.id
            // );

            //while (vpnGroup.firstChild) {
            //  vpnGroup.removeChild(vpnGroup.firstChild);
            // }

            // addLiElement(activeVPN, vpnGroup);

            pageGroupElement.classList.add('selected');
            pageGroupElement.classList.add('bg-indigo-600');
            pageGroupElement.classList.add('text-white');
            pageGroupElement.classList.add('hover:bg-indigo-500');

            pageGroupElement.classList.remove('bg-white');
            pageGroupElement.classList.remove('text-gray-900');
            pageGroupElement.classList.remove('hover:bg-gray-50');
          };

          pageGroup.appendChild(pageGroupElement);
          i++;
        }

        //dates.forEach(async (item, i) => {});
      }

      async function getHistoryTweet() {
        const yearElement = document.getElementById('year');
        const monthElement = document.getElementById('month');
        const dayElement = document.getElementById('day');
        const endDayElement = document.getElementById('end-day');

        const year = yearElement.value;
        const month = monthElement.value;
        const day = dayElement.value;
        const endDay = endDayElement.value;

        await getTweet(year, month, day, endDay);
      }

      async function getMonthlyTweet() {
        const yearElement = document.getElementById('year');
        const monthElement = document.getElementById('month');

        const year = yearElement.value;
        const month = monthElement.value;

        await getTweet(year, month, '');
      }

      async function getYearlyTweet() {
        const yearElement = document.getElementById('year');

        const year = yearElement.value;

        await getTweet(year, '', '');
      }

      async function renewPlan() {
        const tokenElement = document.getElementById('token');
        const tokenStatusElement = document.getElementById('token-status');
        // const tokenErrorElement = document.getElementById('token-error');

        const token = tokenElement.value;

        console.log('token: ', token);

        if (!token) {
          return;
        }

        tokenStatusElement.classList.remove('hidden');

        tokenStatusElement.textContent = '签到中...';

        let temp = [];

        try {
          await fetch(`/renew-plan?token=${token}`);
          tokenStatusElement.textContent = '签到成功!';
        } catch (err) {
          tokenStatusElement.textContent = '签到失败!';
          console.error('error token renew', token);
        }
      }

      async function searchTweet() {
        const searchElement1 = document.getElementById('search1');
        const searchElement2 = document.getElementById('search2');

        const keyword = searchElement1.value || searchElement2.value;

        console.log('keyword: ', keyword);

        if (!keyword) {
          return;
        }

        let temp = [];

        try {
          const res = await fetch(`/search-tweet?keyword=${keyword}`);

          temp = await res.json();
        } catch (err) {
          console.error('error searching data', keyword);
        }

        composePage(temp, '1');
      }

      function composePage(tweetArray) {
        const sort = (a, b) => {
          if (day) {
            return a.createdDate > b.createdDate ? -1 : 1;
          } else {
            return a.views < b.views ? 1 : -1;
          }
        };

        const data = tweetArray?.sort((a, b) => sort(a, b));

        const pdfElement = document.getElementById('tweet');

        const elements = data.map((item) => {
          const images = item?.images?.split(',');

          if (item.videos) {
            const videoImages = item.videos?.split(',');
            images.push(...videoImages);
          }

          let imageElement = '';

          if (images?.length > 0) {
            const imagesArr = images
              .filter((item) => item !== '')
              .map(
                (item) =>
                  `<li class='relative'>
              <div class='group aspect-h-7 aspect-w-10 block w-full overflow-hidden rounded-lg bg-gray-100 focus-within:ring-2 focus-within:ring-indigo-500 focus-within:ring-offset-2 focus-within:ring-offset-gray-100'>
                <img
                  src='/resource${item}'
                  alt=''
                  class='object-cover'
                />
              </div>
            </li>`
              );

            imageElement = imagesArr.join('');
          }

          const createdDate = item?.createdDate?.split(' ')?.[0]?.split('-');

          const year = createdDate?.[0];
          const month = createdDate?.[1];
          const day = createdDate?.[2];

          return `<div class="">
              <div class="bg-white px-4 py-5 sm:px-6">
                <div class="flex space-x-3">
                  <div class="flex-shrink-0">
                    <img
                      class="h-10 w-10 rounded-full"
                      src="images/whyyoutouzhele.jpg"
                      alt=""
                    />
                  </div>
                  <div class="min-w-0 flex-1">
                    <p class="text-lg font-bold text-gray-900">
                      <a href="/tweet-page?year=${year}&month=${month}&day=${day}&id=whyyoutouzhele#${
            item.id
          }" id="${item.id}" class="">李老师不是你老师 @whyyoutouzhele </a>
                      <button onclick="copyTweet('${
                        item.id
                      }')" class="text-normal text-indigo-500">复制分享链接</button>
                    </p>
                    <p class="text-sm text-gray-500">
                      <a href="#" class="">北京时间${item.createdDate}发布</a>
                    </p>
                  </div>
                  <div class="flex flex-shrink-0 self-center">
                    <div class="relative inline-block text-left">
                      <div
                        class="absolute right-0 z-10 mt-2 w-56 origin-top-right rounded-md bg-white shadow-lg focus:outline-none"
                        role="menu"
                        aria-orientation="vertical"
                        aria-labelledby="menu-0-button"
                        tabindex="-1"
                      ></div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="px-4 pb-5 sm:p-6 sm:pt-0">
                <p>
                  ${item?.content
                    ?.replace(/https:\/\/pbs\.twimg\.com\/\S+/g, '')
                    ?.replace(/https:\/\/x\.com\/\S+/g, '')
                    ?.trim()}
                </p>
              </div>
              <ul
                role="list"
                class="grid grid-cols-1 gap-x-1 gap-y-8 sm:gap-x-2 md:grid-cols-2 lg:grid-cols-4 xl:gap-x-4"
              >
                ${imageElement}
              </ul>
            </div>`;
        });

        pdfElement.innerHTML = elements.join('');
      }

      async function getTweet(year, month, day, endDay = '') {
        let temp = [];

        try {
          const res = await fetch(
            `/tweet?year=${year}&month=${month}&day=${day}&endDay=${endDay}&id=whyyoutouzhele`
          );

          temp = await res.json();

          isEmpty = false;
        } catch (err) {
          console.error('error loading data', err);
          isEmpty = true;
        }

        composePage(temp, day);
      }
    </script>

    <script>
      async function getSS() {
        const res = await fetch('/ss-key');

        const ssKeyBase64 = await res.text();

        const ssKeys = ssKeyBase64?.split('\r\n');

        //const ssKey1 = ssKeys?.[0];
        //const ssKey2 = ssKeys?.[1];

        ssKeys.forEach((key, i) => {
          const element = document.getElementById(`outline${i + 1}`);
          element.parentElement.classList.remove('hidden');
          element.innerText = key;
        });

        //const ssElement1 = document.getElementById('outline1');
        //const ssElement2 = document.getElementById('outline2');
        //const ssElement3 = document.getElementById('outline3');
        //const ssElement4 = document.getElementById('outline4');
        //const ssElement5 = document.getElementById('outline5');

        //ssElement1.href = ssKey1;
        //ssElement1.innerText = ssKey1;

        //ssElement2.href = ssKey2;
        //ssElement2.innerText = ssKey2;
      }

      getSS();
    </script>

    <script type="module">
      await fetchTweet();
    </script>

    <script>
      async function getHost() {
        const res = await fetch('/host');

        const dataArr = await res.json();

        const whyElement = document.getElementById('mirror-list');

        dataArr.forEach((item) => {
          const linkElement = document.createElement('a');

          const newLineElement = document.createElement('br');

          if (item.port == 80) {
            linkElement.href = `http://${item.ip}`;

            linkElement.innerText = `http://${item.ip}`;
          } else {
            linkElement.href = `http://${item.ip}:${item.port}/`;

            linkElement.innerText = `http://${item.ip}:${item.port}/`;
          }

          linkElement.target = '_blank';

          whyElement.appendChild(linkElement);
          whyElement.appendChild(newLineElement);
        });
      }

      getHost();
    </script>

    <script>
      async function getHost() {
        const res = await fetch('/apple-account');

        const data = await res.json();

        const appleIdElement = document.getElementById('apple-id');
        const applePasswordElement = document.getElementById('apple-password');
        const appleExpiryElement = document.getElementById('apple-expiry');

        appleIdElement.innerText = data.username;
        applePasswordElement.innerText = data.password;
        appleExpiryElement.innerText = data.expireDate;
      }

      getHost();
    </script>

    <!-- <script>
      async function getCurrentMirrorStatus() {
        const res = await fetch('/check-status');

        const currentMirrorStatus = await res.text();

        const currentMirrorElement = document.getElementById('current-mirror');

        currentMirrorElement.innerText =
          currentMirrorStatus == 'true'
            ? '当前镜像节点状态正常'
            : '当前镜像节点被屏蔽， 请更换IP';
      }

      getCurrentMirrorStatus();
    </script> -->

    <script>
      function copyText(elementId) {
        // Get the text field
        var textToCopy = document.getElementById(elementId);

        // Select the text
        var range = document.createRange();
        range.selectNode(textToCopy);
        window.getSelection().removeAllRanges(); // clear current selection
        window.getSelection().addRange(range); // to select text

        try {
          // Now that we've selected the text, execute the copy command
          var successful = document.execCommand('copy');
          var msg = successful ? 'successful' : 'unsuccessful';
          console.log('Copy text command was ' + msg);
        } catch (err) {
          console.log('Oops, unable to copy', err);
        }

        // Remove the selections - NOTE: Might not be necessary in some cases
        window.getSelection().removeAllRanges();
      }
    </script>

    <script>
      function copyTweet(elementId) {
        // Get the text field
        const linkElement = document.getElementById(elementId);

        // Create a temporary input element to hold the link text
        var tempInput = document.createElement('input');
        tempInput.value = linkElement.href;
        document.body.appendChild(tempInput);

        tempInput.select();
        tempInput.setSelectionRange(0, 99999);

        try {
          // Now that we've selected the text, execute the copy command
          var successful = document.execCommand('copy');
          var msg = successful ? 'successful' : 'unsuccessful';
          console.log('Copy text command was ' + msg);
        } catch (err) {
          console.log('Oops, unable to copy', err);
        }

        // Remove the selections - NOTE: Might not be necessary in some cases
        document.body.removeChild(tempInput);
      }
    </script>

    <script>
      async function getTweetPage() {
        const yearElement = document.getElementById('year');
        const monthElement = document.getElementById('month');
        const dayElement = document.getElementById('day');
        const endDayElement = document.getElementById('end-day');

        const year = yearElement.value;
        const month = monthElement.value;
        const day = dayElement.value;
        const endDay = endDayElement.value;

        try {
          /* const res = await fetch(
            `/tweet-page?year=${year}&month=${month}&day=${day}&id=whyyoutouzhele`
          );*/

          window.open(
            `/tweet-page?year=${year}&month=${month}&day=${day}&endDay=${endDay}&id=whyyoutouzhele`
          );

          /* const htmlContent = await res.text();

          const opt = {
            margin: 1,
            filename: `${year}${month}${day}`,
            image: { type: 'jpeg', quality: 0.98 },
            html2canvas: { scale: 5, useCORS: true },
            jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' },
          };

          html2pdf().from(htmlContent).set(opt).save();
          */
        } catch (err) {
          console.error('getTweetPage err: ', err);
        }
      }

      async function searchTweetPage() {
        const searchElement1 = document.getElementById('search1');
        const searchElement2 = document.getElementById('search2');

        const keyword = searchElement1.value || searchElement2.value;

        if (!keyword) {
          return;
        }

        try {
          window.open(`/search-tweet-page?keyword=${keyword}`);

          /* const htmlContent = await res.text();

          const opt = {
            margin: 1,
            filename: `${keyword}`,
            image: { type: 'jpeg', quality: 0.98 },
            html2canvas: { scale: 3, useCORS: true },
            jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' },
          };

          html2pdf().from(htmlContent).set(opt).save();

          */
        } catch (err) {
          console.error('getTweetPage err: ', err);
        }
      }

      function getYearlyTweetPage() {
        const yearElement = document.getElementById('year');

        const year = yearElement.value;

        // getTweetPage(year, '', '');
      }
    </script>

    <script>
      const getWeekNumber = () => {
        const date = new Date();
        const firstDayOfYear = new Date(date.getFullYear(), 0, 1);
        const pastDaysOfYear =
          (date.getTime() - firstDayOfYear.getTime()) / 86400000; // Milliseconds per day
        //return Math.ceil((pastDaysOfYear + 1) / 7);
        return Math.ceil(pastDaysOfYear / 3);
      };

      const hashWeek = () => {
        const weekNumber = getWeekNumber();
        const hash = CryptoJS.SHA1(weekNumber + '').toString();

        return hash.slice(0, 6);
      };

      const updateLink = () => {
        document.getElementById(
          'v2ray1'
        ).innerText = `https://raw.githubusercontent.com/hello-world-1989/v2-sub/main/end-gfw-together-${hashWeek()}`;
      };

      updateLink();
    </script>
  </body>
</html>
